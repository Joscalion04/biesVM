
$FUN $0 args:0 parent:$0
    ; Inicializamos la variable de conteo en 0
    LDV 0        ; Empuja 0 a la pila
    BST 0 0      ; Almacena el contador en el binding 0, posición 0
    
    ; Cargamos la hilera en la pila
    LDV "miCadena"  ; Cargar la hilera en la pila
    BST 0 1         ; Guardamos la hilera en el binding 0, posición 1

    ; Llamamos a la función de conteo
    LDF $1          ; Cargamos la función de conteo en la pila
    APP 0           ; Ejecutamos la función sin argumentos

    ; Fin del programa
    HLT             ; Detenemos la ejecución
$END

$FUN $1 args:0 parent:$0
    ; Cargar la hilera actual desde el binding 0, posición 1
    BLD 0 1
    SNT          ; Verificamos si la hilera está vacía
    BT 2      ; Si la hilera está vacía, saltamos al final

    ; Incrementamos el contador
    BLD 0 0      ; Cargamos el valor actual del contador
    LDV 1        ; Cargamos 1
    ADD          ; Sumamos 1 al contador
    BST 0 0      ; Guardamos el nuevo valor del contador

    ; Eliminamos el primer carácter de la hilera
    BLD 0 1      ; Cargamos la hilera
    LDV 1        ; Cargamos el valor 1
    SRK          ; Eliminamos el primer carácter de la hilera
    BST 0 1      ; Guardamos la hilera actualizada en el binding

    ; Volvemos a llamar la función recursivamente
    LDF $1       ; Cargamos la función de conteo
    APP 0        ; Ejecutamos la función sin argumentos
$END

; Etiqueta para terminar el ciclo
$2:
    BLD 0 0      ; Cargamos el valor final del contador
    PRN          ; Imprimimos el largo de la hilera
    RET          ; Retornamos de la función
$END
